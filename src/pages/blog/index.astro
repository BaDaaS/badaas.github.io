---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout title="Blog | BaDaaS" description="Technical articles from BaDaaS">
  <section class="prose max-w-content mx-auto px-5 pt-32 pb-16">
    <h1 class="text-4xl md:text-[2.5rem]">Blog</h1>
    <p class="text-text-muted mb-10">
      Technical articles on cryptography, security, and software development.
    </p>

    {
      posts.length === 0 ? (
        <p>No posts yet. Check back soon!</p>
      ) : (
        <div>
          {posts.map(post => (
            <div class="border-border border-b py-8 last:border-b-0">
              <h3 class="mb-2.5">
                <a
                  href={`/blog/${post.slug}`}
                  class="text-accent hover:opacity-80"
                >
                  {post.data.title}
                </a>
              </h3>
              <p class="text-text-muted mb-2.5 text-sm">
                {post.data.pubDate.toLocaleDateString("en-US", {
                  year: "numeric",
                  month: "long",
                  day: "numeric",
                })}
              </p>
              <p class="text-text">{post.data.description}</p>
            </div>
          ))}
        </div>
      )
    }
  </section>
</BaseLayout>
